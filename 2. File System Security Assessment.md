# File System Security Assessment: Detecting Unauthorized Access and Modifications

## Introduction
File system security is essential for ensuring that sensitive data is protected from unauthorized access and modifications. This project will guide us through a file system security assessment, focusing on identifying unauthorized access and changes to files. We will use various tools to monitor, analyze, and secure the file system.

## Pre-requisites
- Basic understanding of file system concepts (permissions, file types, etc.)
- Familiarity with the Linux command line
- A computer with a Linux operating system
- Internet connection to download necessary tools

## Lab Setup and Tools
- **Lab Environment**: A single Linux machine with sudo access.
- **Tools**:
  - Auditd
  - Tripwire
  - AIDE (Advanced Intrusion Detection Environment)
  - OSSEC
  - Chkrootkit

## Exercises

### Exercise 1: Monitoring File Access with Auditd
**Objective**: Use Auditd to monitor and log file access events.

**Steps**:
1. **Install Auditd**:
   
    ```sh
    sudo apt update
    sudo apt install auditd audispd-plugins -y
    ```

    <img width="1754" height="923" alt="1" src="https://github.com/user-attachments/assets/ffde1996-4fbf-4ae0-8984-0821e9b8710e" />

2. **Configure Audit Rules**:
   
    ```sh
    sudo auditctl -w /etc/passwd -p wa -k passwd_changes
    ```

   - This command sets up monitoring for write and attribute change access to `/etc/passwd`.

3. **View Audit Logs**:
. 
    ```sh
    sudo ausearch -k passwd_changes
    ```
     <img width="1920" height="421" alt="2" src="https://github.com/user-attachments/assets/949c107f-ae17-46bf-a878-f2ed5a5fdf57" />


**Expected Output**:
- Log entries showing access events for the monitored file.

### Exercise 2: File Integrity Monitoring with Tripwire
**Objective**: Use Tripwire to detect unauthorized changes to files.

**Steps**:
1. **Install Tripwire**:

   ```sh
    sudo apt install tripwire -y
    ```
    <img width="1749" height="946" alt="3" src="https://github.com/user-attachments/assets/bc674045-af27-4aac-8dfb-9abbb5a8358c" />

2. **Initialize Tripwire Database**:

   ```sh
    sudo tripwire --init
    ```

    <img width="530" height="923" alt="4" src="https://github.com/user-attachments/assets/06efba51-aaa2-4803-9977-bca3dd1719d6" />

3. **Run a File Integrity Check**:

   ```sh
    sudo tripwire --check
    ```

    <img width="403" height="927" alt="5" src="https://github.com/user-attachments/assets/daf83825-2c5d-4f63-87c7-b7d55ccd51aa" />

**Expected Output**:
- Report detailing any changes or modifications to the monitored files.

### Exercise 3: System Integrity Check with AIDE
**Objective**: Use AIDE to perform a system integrity check.

**Steps**:
1. **Install AIDE**:

   ```sh
    sudo apt install aide -y
    ```

    <img width="1746" height="951" alt="6" src="https://github.com/user-attachments/assets/12519a60-a9c6-45c6-bc6a-e7959b190414" />

2. **Initialize AIDE Database**:

   ```sh
    sudo aideinit
    ```

    <img width="521" height="255" alt="7" src="https://github.com/user-attachments/assets/adcb18ba-0073-4f45-99ec-77d67a920cb5" />

3. **Run an Integrity Check**:
    ```sh
    sudo aide --check
    ```

    <img width="701" height="346" alt="Check-File-System-Changes" src="https://github.com/user-attachments/assets/4b23ef29-c158-4f9d-9a4f-6105792c646a" />

**Expected Output**:
- Report highlighting any differences between the current file system state and the baseline.

### Exercise 4: Host-Based Intrusion Detection with OSSEC
**Objective**: Use OSSEC to monitor the system for suspicious activity.

**Steps**:
1. **Install OSSEC**:

   ```sh
    wget -q -O - https://updates.atomicorp.com/installers/atomic | sudo bash
    sudo yum install ossec-hids ossec-hids-server
    ```

    <img width="819" height="935" alt="8" src="https://github.com/user-attachments/assets/5073fb5c-458e-4f71-8e66-1e51a8592090" />

2. **Configure OSSEC**:
    - Edit `/var/ossec/etc/ossec.conf` to define what should be monitored.

3. **Start OSSEC**:

   ```sh
    sudo /var/ossec/bin/ossec-control start
    ```

    <img width="518" height="407" alt="9" src="https://github.com/user-attachments/assets/bb5c5af3-79a3-4c28-af0f-bb9af3080d95" />

4. **View Alerts**:

   ```sh
    sudo tail -f /var/ossec/logs/alerts/alerts.log
    ```
   
    <img width="542" height="358" alt="10" src="https://github.com/user-attachments/assets/ea9154d4-6a6f-4935-897c-b001a0bc91b0" />

**Expected Output**:
- Log entries showing detected suspicious activity.

### Exercise 5: Rootkit Detection with Chkrootkit
**Objective**: Use Chkrootkit to detect rootkits on the system.

**Steps**:
1. **Install Chkrootkit**:

   ```sh
    sudo apt install chkrootkit -y
    ```

    <img width="1731" height="725" alt="11" src="https://github.com/user-attachments/assets/a6fcc61f-5206-4ad0-9ea0-299afaddbbb9" />

2. **Run Chkrootkit**:

    ```sh
    sudo chkrootkit
    ```

    <img width="643" height="927" alt="12" src="https://github.com/user-attachments/assets/4180bef1-09d1-4fa6-a2c9-e59ca8c0872a" />

**Expected Output**:
- Report indicating whether any rootkits were found on the system.

## Conclusion
By completing these exercises, we have learned how to monitor and assess file system security to detect unauthorized access and modifications. These skills are essential for maintaining the integrity and confidentiality of sensitive data in our system.
