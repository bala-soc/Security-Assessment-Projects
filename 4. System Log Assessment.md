# System Log Assessment: Analyzing Logs for Potential Security Incidents

## Introduction
System logs are vital for tracking system activities, diagnosing issues, and identifying potential security incidents. This project will guide us through a system log assessment, focusing on analyzing logs to detect suspicious activities. We will use various tools to collect, analyze, and interpret log data.

## Pre-requisites
- Basic understanding of system logging concepts (log files, log levels, etc.)
- Familiarity with the Linux command line
- A computer with a Linux operating system
- Internet connection to download necessary tools

## Lab Setup and Tools
- **Lab Environment**: A single Linux machine with sudo access.
- **Tools**:
  - Rsyslog
  - Logwatch
  - Logrotate
  - Splunk
  - ELK Stack (Elasticsearch, Logstash, Kibana)

## Exercises

### Exercise 1: Configuring Centralized Logging with Rsyslog
**Objective**: Configure Rsyslog for centralized logging and ensure logs are collected in a centralized location.

**Steps**:
1. **Install Rsyslog**:
   
    ```sh
    sudo apt-get update
    sudo apt-get install rsyslog -y
    ```

    <img width="1747" height="917" alt="1" src="https://github.com/user-attachments/assets/b8c5b1e1-856f-4804-b730-43dbba38e1de" />

2. **Configure Rsyslog**:
    - Edit `/etc/rsyslog.conf` to enable centralized logging.
    - Add the following lines to forward logs to a remote log server:
      
        ```sh
        *.* @10.10.1.19:514
        ```
        <img width="682" height="925" alt="2" src="https://github.com/user-attachments/assets/a08c81d3-aeb8-42fe-a5a9-304e155bdb8b" />
    - Replace `10.10.1.19` with the IP address of our remote log server.

3. **Restart Rsyslog**:
   
    ```sh
    sudo systemctl restart rsyslog
    ```
    
      <img width="508" height="264" alt="3" src="https://github.com/user-attachments/assets/0d52dc8c-2400-4ac4-b210-f76583f3d1b4" />

**Expected Output**:
- Logs should be forwarded to the specified remote log server.

### Exercise 2: Log Analysis with Logwatch
**Objective**: Use Logwatch to generate daily reports from system logs.

**Steps**:
1. **Install Logwatch**:
   
    ```sh
    sudo apt-get install logwatch
    ```

      <img width="1920" height="670" alt="4" src="https://github.com/user-attachments/assets/9f3787d3-a031-4fbe-8a3b-3ce1a371139b" />

2. **Generate a Log Report**:
   
    ```sh
    sudo logwatch --detail high --logfile /var/log/syslog --range today --service all --print
    ```

    <img width="1142" height="878" alt="5" src="https://github.com/user-attachments/assets/503d2411-41d3-47f7-ab3a-3a427f37a614" />

**Expected Output**:
- Detailed log report summarizing system activities for the day.

### Exercise 3: Log Rotation with Logrotate
**Objective**: Use Logrotate to manage and rotate log files to prevent them from growing indefinitely.

**Steps**:
1. **Configure Logrotate**:
    - Edit or create a configuration file for our logs, e.g., `/etc/logrotate.d/custom_logs`:
      
        ```sh
        /var/log/custom_log {
            daily
            rotate 7
            compress
            missingok
            notifempty
            create 0640 root utmp
        }
        ```

2. **Test Logrotate Configuration**:
   
    ```sh
    sudo logrotate -d /etc/logrotate.d/custom_logs
    ```

    <img width="1226" height="878" alt="6" src="https://github.com/user-attachments/assets/8658dfa0-243c-46c0-a61f-35761bb37919" />

**Expected Output**:
- Log files should be rotated daily, with the last 7 days retained, and compressed to save space.

### Exercise 4: Real-time Log Monitoring with Splunk
**Objective**: Use Splunk to collect, index, and monitor system logs in real-time.

**Steps**:
1. **Install Splunk**:
   
    ```sh
    wget -O splunk-8.0.5-152fb4b2bb96-Linux-x86_64.deb "https://www.splunk.com/page/download_track?file=8.0.5/linux/splunk-8.0.5-152fb4b2bb96-Linux-x86_64.deb"
    sudo dpkg -i splunk-8.0.5-152fb4b2bb96-Linux-x86_64.deb
    ```

2. **Start Splunk**:
   
    ```sh
    sudo /opt/splunk/bin/splunk start --accept-license
    sudo /opt/splunk/bin/splunk enable boot-start
    ```

    <img width="1257" height="919" alt="7" src="https://github.com/user-attachments/assets/c5c5d878-254a-468e-bf2d-2666875af30f" />

3. **Add Data Sources**:
    - Access Splunk web interface at `http://localhost:8000`.
      
    <img width="835" height="336" alt="8" src="https://github.com/user-attachments/assets/62cafa3d-6d9e-4f5a-9b17-e35fc8ec425b" />

    - Add `TCP/UDP` directory as a data source to monitor system logs.

    <img width="1626" height="733" alt="9" src="https://github.com/user-attachments/assets/deeb8489-b21e-4334-b9ff-f921bb78b743" />

    <img width="1918" height="828" alt="10" src="https://github.com/user-attachments/assets/600300ee-4989-4463-a38c-8e3141b82fd8" />

**Expected Output**:
- Real-time log monitoring dashboard in Splunk showing collected logs.

### Exercise 5: Visualizing Log Data with the ELK Stack
**Objective**: Use the ELK Stack (Elasticsearch, Logstash, Kibana) to collect, process, and visualize log data.

**Steps**:
1. **Install Elasticsearch**:
   
    ```sh
    sudo apt-get install elasticsearch
    sudo systemctl start elasticsearch
    sudo systemctl enable elasticsearch
    ```

    <img width="601" height="392" alt="12" src="https://github.com/user-attachments/assets/1f057b28-7fca-4f7d-adf0-bbd131f7a2bb" />

2. **Install Logstash**:
   
    ```sh
    sudo apt-get install logstash
    ```

    <img width="553" height="325" alt="13" src="https://github.com/user-attachments/assets/3f9cc3eb-0b74-4b8a-b464-8d6b768d1ffc" />

3. **Configure Logstash**:
   
    - Create a configuration file `/etc/logstash/conf.d/logstash.conf`:
    ```sh
    input {
          file {
            path => "/var/log/syslog"
            start_position => "beginning"
          }
        }
        output {
          elasticsearch {
            hosts => ["localhost:9200"]
            index => "syslog"
          }
        }
    ```
      
    <img width="419" height="327" alt="15" src="https://github.com/user-attachments/assets/f257727f-9ea2-4f90-935b-bf45fb3b16a4" />

4. **Start Logstash**:
   
    ```sh
    sudo systemctl start logstash
    sudo systemctl enable logstash
    ```

    <img width="1024" height="242" alt="16" src="https://github.com/user-attachments/assets/94b1df01-4da2-40ad-9c83-0e7a7efacdac" />

5. **Install Kibana**:
    
    ```sh
    sudo apt-get install kibana
    sudo systemctl start kibana
    sudo systemctl enable kibana
    ```
    <img width="999" height="336" alt="17" src="https://github.com/user-attachments/assets/b4a2518b-8785-4a8e-81eb-17c2ddaf2f0e" />


6. **Access Kibana**:
    - Open a browser and navigate to `http://localhost:5601`.
    - Configure Kibana to use the `syslog` index and create visualizations.

    <img width="1536" height="1024" alt="11" src="https://github.com/user-attachments/assets/65739f2a-4eab-4ad6-9230-2c471a1f149c" />

**Expected Output**:
- Interactive dashboards in Kibana displaying log data from Elasticsearch.

## Conclusion
By completing these exercises, we have learned how to collect, analyze, and interpret system logs using various tools. These skills are essential for detecting and responding to potential security incidents in our system.
