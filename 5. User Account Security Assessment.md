# User Account Security Assessment: Evaluating User Permissions and Activity Logs

## Introduction
User account security is critical for preventing unauthorized access and ensuring that users have appropriate permissions. This project will guide us through a user account security assessment, focusing on evaluating user permissions and analyzing user activity logs. We will use various tools to audit, analyze, and secure user accounts.

## Pre-requisites
- Basic understanding of user account concepts (usernames, groups, permissions, etc.)
- Familiarity with the Linux command line
- A computer with a Linux operating system (preferably Ubuntu)
- Internet connection to download necessary tools

## Lab Setup and Tools
- **Lab Environment**: A single Linux machine with sudo access.
- **Tools**:
  - PAM (Pluggable Authentication Modules)
  - chkpasswd
  - sudo
  - usermod
  - faillock

## Exercises

### Exercise 1: Auditing User Accounts with PAM
**Objective**: Use PAM to audit user accounts and log authentication attempts.

**Steps**:
1. **Install PAM**:

   ```sh
    sudo apt-get update
    sudo apt-get install libpam0g-dev
    ```

    <img width="1920" height="832" alt="1" src="https://github.com/user-attachments/assets/c5a83c24-e060-46e5-81c4-0f33cf16c983" />

2. **Configure PAM**:
    - Edit `/etc/pam.d/common-auth` to add the following line:
    <img width="459" height="202" alt="2 1" src="https://github.com/user-attachments/assets/74c29e93-26a4-4b57-8ce3-9146b8dd912b" />
   
      ```sh
        auth required pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900
      ```

    <img width="950" height="610" alt="2" src="https://github.com/user-attachments/assets/cdda8334-a5cc-45e0-b408-1ad1240c1a82" />

      - This configuration will lock a user account for 15 minutes after 5 failed login attempts.

3. **View PAM Logs**:

   ```sh
    sudo tail -f /var/log/auth.log
    ```
    <img width="1440" height="389" alt="3" src="https://github.com/user-attachments/assets/15d6b79d-1ec3-45a4-a448-795575b2f043" />

**Expected Output**:
- Authentication logs showing login attempts and account locks.

### Exercise 2: Checking Password Strength with chkpasswd
**Objective**: Use chkpasswd to check the strength of user passwords.

**Steps**:
1. **Install chkpasswd**:
   
    ```sh
    sudo apt update
    sudo apt install libpam-pwquality
    ```
    
    <img width="1750" height="531" alt="4" src="https://github.com/user-attachments/assets/fee3dd57-bdaf-4ca4-b9d2-e48aaf384a23" />

2. **Check Password Strength**:
   
    ```sh
    sudo nano /etc/security/pwquality.conf
    ```
    <img width="512" height="225" alt="5" src="https://github.com/user-attachments/assets/434067cf-2e5f-4215-b1b6-66bd3bb34374" />
    <img width="650" height="919" alt="6" src="https://github.com/user-attachments/assets/3fc42aba-cb9e-4b33-b06c-192f08e0cbbc" />

3. **Review Password Policies**:
    - Ensure that the password policies meet the organizationâ€™s security standards (minimum length, complexity, etc.).

    <img width="562" height="323" alt="7" src="https://github.com/user-attachments/assets/6d07ae13-89ca-4c8d-82ab-542e813d4cf1" />

**Expected Output**:
- Report detailing the strength of user passwords and compliance with password policies.

### Exercise 3: Auditing Sudo Permissions with sudo
**Objective**: Use sudo to audit user permissions and ensure appropriate access controls.

**Steps**:
1. **List Sudoers**:
   
    ```sh
    sudo cat /etc/sudoers
    sudo ls /etc/sudoers.d/
    ```
    <img width="754" height="926" alt="8" src="https://github.com/user-attachments/assets/e2fe4aeb-a558-4a79-9039-f53a9130e2da" />
    <img width="737" height="934" alt="9" src="https://github.com/user-attachments/assets/94e9f59d-1ecf-45cb-8717-4c3ce61f2d03" />

2. **Check User Permissions**:
   
    ```sh
    sudo -l -U username
    ```

    <img width="952" height="327" alt="10" src="https://github.com/user-attachments/assets/16a5eb7d-b6c2-4b3e-a5ab-25f6f5064d06" />

   - Replace `username` with the user you want to audit.

3. **Review and Adjust Permissions**:
    - Edit `/etc/sudoers` or files in `/etc/sudoers.d/` to ensure users have the appropriate level of access.

    <img width="483" height="261" alt="11" src="https://github.com/user-attachments/assets/68c45bdd-6a81-421d-b7aa-fa29f8613fd3" />
    <img width="754" height="923" alt="12" src="https://github.com/user-attachments/assets/ec2d7911-7833-45bc-98ac-0354aa2f94b8" />


**Expected Output**:
- List of users with sudo privileges and their specific permissions.

### Exercise 4: Modifying User Permissions with usermod
**Objective**: Use usermod to modify user permissions and group memberships.

**Steps**:
1. **Add User to Group**:
   
    ```sh
    sudo usermod -aG groupname username
    ```

    <img width="427" height="245" alt="13" src="https://github.com/user-attachments/assets/b32306ed-ceed-4163-85b9-69c55ef1c2ee" />

   - Replace `groupname` with the group and `username` with the user we want to modify.

2. **Remove User from Group**:
   
    ```sh
    sudo gpasswd -d username groupname
    ```

    <img width="420" height="272" alt="14" src="https://github.com/user-attachments/assets/ce83b697-e1b0-4bd2-978a-a98d8ba56abb" />

3. **Verify Group Memberships**:
   
    ```sh
    groups username
    ```

    <img width="975" height="281" alt="15" src="https://github.com/user-attachments/assets/28be6ae4-2f94-4ff3-8f03-61b7887b16ec" />

**Expected Output**:
- Confirmation of changes to user group memberships.

### Exercise 5: Analyzing Failed Login Attempts with faillock
**Objective**: Use faillock to analyze failed login attempts and identify potential security issues.

**Steps**:
1. **View Failed Login Attempts**:
   
    ```sh
    sudo faillock
    ```

    <img width="768" height="312" alt="16" src="https://github.com/user-attachments/assets/ebd8402a-4266-4deb-9772-80bb74bcae66" />

2. **Reset Failed Login Count for a User**:
   
    ```sh
    sudo  --user kali --reset
    ```

    <img width="502" height="295" alt="17" src="https://github.com/user-attachments/assets/3baed6af-7b76-4188-9b00-9e93254d483c" />

   - Replace `username` with the user whose failed login count we want to reset.

3. **Configure Login Failure Limits**:
    - Edit `/etc/login.defs` to set the maximum number of allowed failed login attempts:
    <img width="385" height="204" alt="18 1" src="https://github.com/user-attachments/assets/c41f3a25-a16f-41f2-98ea-284d8c9efb4d" />

      ```sh
        faillock_ENAB yes
        FAIL_DELAY 4
        LOGIN_RETRIES 5
      ```

    <img width="690" height="925" alt="18" src="https://github.com/user-attachments/assets/825b3e52-2eee-4e18-af90-f75a08f025d4" />

**Expected Output**:
- List of failed login attempts and confirmation of any resets or configuration changes.

## Conclusion
By completing these exercises, we have learned how to evaluate user permissions and analyze user activity logs to ensure user account security. These skills are essential for preventing unauthorized access and maintaining the integrity of user accounts in your system.
